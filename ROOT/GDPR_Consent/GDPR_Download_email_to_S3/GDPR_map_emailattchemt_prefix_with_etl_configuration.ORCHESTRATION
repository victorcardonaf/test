{"job":{"components":{"877675":{"id":877675,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-658,"y":-73,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[877677],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"877676":{"id":877676,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-312,"y":-85,"width":32,"height":32,"inputConnectorIDs":[877677],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into tmp_gdpr_consent_attachments_detail"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import time, imaplib\nimport email.header\nimport os\nimport sys\nimport datetime\nimport boto3\n\nimap_server = \"imap.outlook.com\"\nemailaddress = \"GDPRConsent@geniussports.com\"\npassword = \"Dafne01@\"\n\n# Connect to the server\nprint('Connecting to ' + imap_server)\nemail_conn = imaplib.IMAP4_SSL(imap_server)\n\n# Login to our account\nlogin_status, login_detail = email_conn.login(emailaddress, password)\n\nprint(login_status, login_detail)\n\nif login_status != 'OK':\n    print 'log in error : ', login_detail, login_status\n\n\n\n\nemail_conn.select('Inbox')\n\neid = email_id\nresult, email_data = email_conn.fetch(eid, '(RFC822)')\nmsg = email.message_from_string(email_data[0][1])\ncursor = context.cursor() \nfor part in msg.walk():\n    # print(part)\n    # print  part.get_content_maintype()  , 'file name : ' ,part.get_filename() ,bool(part.get_filename())\n    fname = part.get_filename()\n    if bool(fname):        \n        fileprefix =  (fname.split('_')[0]).strip()\n        print 'email id :',eid ,'filename: ' ,fname ,fileprefix\n        sql_ins = (\"insert into loading.tmp_gdpr_consent_attachments_detail (id ,attachments,fileprefix) select %s ,'%s','%s' \" %(eid,fname,fileprefix))\n        cursor.execute(sql_ins)\n\nemail_conn.close()\nemail_conn.logout()\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"877677":{"id":877677,"sourceID":877675,"targetID":877676}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{},"grids":{}},"info":{"name":"GDPR_map_emailattchemt_prefix_with_etl_configuration","description":"","type":"ORCHESTRATION"}}