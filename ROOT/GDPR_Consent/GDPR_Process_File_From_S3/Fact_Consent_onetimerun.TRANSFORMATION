{"job":{"components":{"877777":{"id":877777,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":57,"y":202,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[877779],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get data"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select  dim.dimconsentid,dim.accountid,dim.clientid,dim.iab_purpose_id,\t\tdim.consentprovided,dim.consentdate,\n  case  when fc.dimconsentid is null then 'true' else 'false' end as isnewrow , getdate() as record_updateddate\n\nfrom (\n\n\tselect\n\t\tdim.dimconsentid,\n\t\tdim.accountid,\n\t\tdim.clientid,\n\t\tdim.client_purpose_id,\n  \t\tdim.iab_purpose_id ,\n  \t\tdim.consentprovided,\n\t\tdim.consentdate,\n\t\trow_number()\n\t\tover (\n\t\t\tpartition by dim.accountid, dim.clientid, dim.iab_purpose_id\n\t\t\torder by dim.consentdate desc ) rowidx\n\n\tfrom consent.dim_consent dim\n  \twhere exists (\n      \t\t\tselect null \n                  from consent.dim_consent s \n                  where dim.accountid= s.accountid and dim.clientid = s.clientid \n      \t\t\t\t\tand s.filename = 'geniussports-gdprconsent-bi-drueckglueck-prod/drueckglueck_20180802.csv.gz' \n      \t\t\t)\n\n\t\t\t) as dim\nLEFT JOIN consent.fact_consent fc\n  on dim.accountid = fc.accountid\n  and dim.clientid =  fc.clientid\n  and dim.iab_purpose_id = fc.iab_purpose_id\n\nwhere dim.rowidx =1\n\n\n\n\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"877778":{"id":877778,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":451,"y":254,"width":32,"height":32,"inputConnectorIDs":[877779],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_consent"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"fact_consent"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dimconsentid"},"2":{"slot":2,"type":"STRING","value":"dimconsentid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"consentprovided"},"2":{"slot":2,"type":"STRING","value":"consentprovided"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"consentdate"},"2":{"slot":2,"type":"STRING","value":"consentdate"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"record_updateddate"},"2":{"slot":2,"type":"STRING","value":"updatedate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"accountid"},"2":{"slot":2,"type":"STRING","value":"accountid"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"clientid"},"2":{"slot":2,"type":"STRING","value":"clientid"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"iab_purpose_id"},"2":{"slot":2,"type":"STRING","value":"iab_purpose_id"}}}},"visible":true},"5":{"slot":5,"name":"Unique Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"accountid"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"clientid"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"iab_purpose_id"}}}},"visible":true},"6":{"slot":6,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"consent"}}}},"visible":true},"7":{"slot":7,"name":"Update Strategy","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update/Insert"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"877779":{"id":877779,"sourceID":877777,"targetID":877778}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"Fact_Consent_onetimerun","description":"","type":"TRANSFORMATION"}}