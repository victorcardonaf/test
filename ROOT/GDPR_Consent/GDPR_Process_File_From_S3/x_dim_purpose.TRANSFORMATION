{"job":{"components":{"877762":{"id":877762,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":180,"y":22,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[877771],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gdpr stage table"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${stagetablename}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"purpose"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"loading"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"877763":{"id":877763,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":179,"y":199,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[877768],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_purpose"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_purpose"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"purpose"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"consent"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"877764":{"id":877764,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-2139546284,"x":387,"y":129,"width":32,"height":32,"inputConnectorIDs":[877768,877771],"outputConnectorIDs":[877769],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Except 0"}}}},"visible":true},"2":{"slot":2,"name":"Cast Types","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Primary Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gdpr stage table"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"877765":{"id":877765,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":649,"y":138,"width":32,"height":32,"inputConnectorIDs":[877770],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_purpose_load"}}}},"visible":true},"2":{"slot":2,"name":"Target Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dim_purpose"}}}},"visible":true},"3":{"slot":3,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"purpose"},"2":{"slot":2,"type":"STRING","value":"purpose"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"6":{"slot":6,"name":"Automatic Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"consent"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"877766":{"id":877766,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1744268877,"x":521,"y":161,"width":32,"height":32,"inputConnectorIDs":[877769],"outputConnectorIDs":[877770],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Distinct 0"}}}},"visible":true},"2":{"slot":2,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"purpose"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"877767":{"id":877767,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":2,"y":102,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get unique purpose"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert inot \n\nSELECT\n  distinct lower(st.purpose) as purpose ,coalesce(dpt.purposetypeid,1) purposetypeid\nFROM \"loading\".${stagetablename} st\nleft join consent.dim_purpose dp\non lower(st.purpose) = lower(dp.purpose)\nleft join \n\t consent.dim_purpose_type dpt\n     on dp.purposetypeid = dpt.purposetypeid\nwhere dp.purposeid is null "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"877769":{"id":877769,"sourceID":877764,"targetID":877766},"877768":{"id":877768,"sourceID":877763,"targetID":877764},"877771":{"id":877771,"sourceID":877762,"targetID":877764},"877770":{"id":877770,"sourceID":877766,"targetID":877765}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"x_dim_purpose","description":"","type":"TRANSFORMATION"}}